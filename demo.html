<! DOCTYPE html>

<head>
    <meta charset="utf-8">
    <title>Demo</title>
    <link href='https://api.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.css' rel='stylesheet' />
    <link href="style.css" rel="stylesheet" />
    <script src='https://api.mapbox.com/mapbox-gl-js/v0.44.0/mapbox-gl.js'></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.2/Chart.js"></script>
    <script src="Highmaps-6/code/highcharts.js"></script>
    <script src='Highmaps-6/code/js/modules/map.js'></script>
    <script src="Highmaps-6/code/modules/data.js"></script>
    <script src="https://code.highcharts.com/mapdata/countries/us/us-all.js"></script>
    <script src='jquery-3.3.1.js'></script>
</head>

<body style="background-color: #f6f6f6;">

    <div id="searchBar" class="fixed">
        <p style="padding-left: 15px; margin-top: 13px;">Peet's Coffee and Tea</p>
    </div>
    <div id="dateBar" class="fixed">
        <p style="padding-left: 15px; margin-top: 13px;">Past 5 minutes</p>
    </div>

    <div id="container" class="fixed">
        <div id="tabs" class="fixed">
            <a href="index.html"><h2 style="margin-right: 10px;" class="inline">Footfall</h2></a>
            <a href="behavior.html"><h2 style="margin-right: 10px;"  class="inline">Behavior</h2></a>
            <a href="demo.html" class="active"><h2 style="margin-right: 10px;"  class="inline">Demographics</h2></a>
            <a href="user.html"><h2 style="margin-right: 10px;"  class="inline">User Journey</h2></a>
        </div>

        <div id='map' class="fixed"></div>

        <div id='ageDiv' class="fixed leftChart">
            <h3>Visitor Age</h3>
            <canvas id="age" width="400" height="200"></canvas>
        </div>

        <div id='incomeDiv' class="fixed leftChart">
            <h3>Visitor Income</h3>
            <canvas id="income" width="400" height="400"></canvas>
        </div>

        <div id='homeRegionDiv' class="fixed" style="width: 800px; height: 420px;">
            <h3>Home Regions More Likely to Visit</h3>
            <canvas id="homeRegion" width="1200" height="420"></canvas>
        </div>

    </div>


    <script>
        //Highmap
        $.getJSON('https://cdn.rawgit.com/highcharts/highcharts/v6.0.4/samples/data/us-population-density.json', function(data) {

            // Make codes uppercase to match the map data
            $.each(data, function() {
                this.code = this.code.toUpperCase();
            });

            // Instantiate the map
            Highcharts.mapChart('map', {

                chart: {
                    map: 'countries/us/us-all',
                    borderWidth: 1
                },

                title: {
                    text: 'Top Home Regions'
                },

                exporting: {
                    sourceWidth: 600,
                    sourceHeight: 500
                },


                mapNavigation: {
                    enabled: true
                },

                colorAxis: {
                    min: 1,
                    type: 'logarithmic',
                    minColor: '#FFF0E0',
                    maxColor: '#FB8D2B',
                    stops: [
                        [0, '#FFF0E0'],
                        [0.67, '#FFB361'],
                        [1, '#FB8D2B']
                    ]
                },

                series: [{
                    animation: {
                        duration: 1000
                    },
                    data: data,
                    joinBy: ['postal-code', 'code'],
                    dataLabels: {
                        enabled: true,
                        color: '#333',
                        format: '{point.code}'
                    },
                    name: 'Visitors from this region',
                    tooltip: {
                        pointFormat: '{point.code}: {point.value}'
                    }
                }]
            });
        });
        //Visitor Age
        var a = document.getElementById("age").getContext('2d');
        var age = new Chart(a, {
            type: 'doughnut',
            data: {
                labels: ["18-24", "25-34", "35-44", "45-54", "55-64", "66+"],
                datasets: [{
                    data: [76915, 33565, 42929, 2925, 12349, 1018],
                    backgroundColor: ['RGBA(251, 141, 43, .8)', 'RGBA(64, 133, 232, .8)', 'RGBA(108, 202, 213, .8)', 'RGBA(250, 82, 81, .8)', 'RGBA(103, 103, 241, .8)', 'RGBA(176, 116, 175, .8)', ],
                    borderColor: ['RGBA(251, 141, 43, 1.00)', 'RGBA(64, 133, 232, 1.00)', 'RGBA(108, 202, 213, 1.00)', 'RGBA(250, 82, 81, 1.00)', 'RGBA(103, 103, 241, 1.00)', 'RGBA(176, 116, 175, 1.00)', ],
                    borderWidth: 2
                }, ]
            },
            options: {

                legend: {
                    display: true,
                    position: 'right',
                },
            }
        });


        //Visitor Income
        var inc = document.getElementById("income").getContext('2d');
        var income = new Chart(inc, {
            type: 'horizontalBar',
            data: {
                labels: ["Peet\'s Coffee and Tea", "Cafes, Coffee Shops, and Tea Houses", "US Population"],
                datasets: [{
                    label: '$0-25k',
                    data: [1960 / 159111, 1020 / 147571, 2160 / 147511],
                    backgroundColor: 'RGBA(251, 141, 43, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$25-50k',
                    data: [5381 / 159111, 3981 / 147571, 3481 / 147511],
                    backgroundColor: 'RGBA(64, 133, 232, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$50-75k',
                    data: [2115 / 159111, 4915 / 147571, 1215 / 147511],
                    backgroundColor: 'RGBA(108, 202, 213, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$75-100k',
                    data: [12186 / 159111, 11086 / 147571, 16186 / 147511],
                    backgroundColor: 'RGBA(250, 82, 81, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$100-125k',
                    data: [25339 / 159111, 24839 / 147571, 20339 / 147511],
                    backgroundColor: 'RGBA(103, 103, 241, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$125-150k',
                    data: [36412 / 159111, 31012 / 147571, 31412 / 147511],
                    backgroundColor: 'RGBA(176, 116, 175, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$150-175k',
                    data: [43505 / 159111, 41505 / 147571, 40505 / 147511],
                    backgroundColor: 'RGBA(254, 106, 117, .8)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$175-200k',
                    data: [4706 / 159111, 3706 / 147571, 4706 / 147511],
                    backgroundColor: 'RGBA(95, 165, 214, .80)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, {
                    label: '$200k+',
                    data: [27507 / 159111, 25507 / 147571, 27507 / 147511],
                    backgroundColor: 'RGBA(162, 237, 220, .80)',
                    borderColor: 'rgb(255,255,255)',
                    borderWidth: 1
                }, ]
            },
            options: {
                scales: {
                    xAxes: [{
                        ticks: {
                            beginAtZero: true,
                        },
                        stacked: true,
                        scaleLabel: {
                            display: true,
                            labelString: '% of Visitors',
                        }
                    }],
                    yAxes: [{
                        gridLines: {
                            offsetGridLines: false
                        },
                        stacked: true,
                        ticks: {
                            maxRotation: 0,
                            autoSkip: false,
                            callback: function(value) {
                                return (value.substr(0, 12) + '...'); //truncate
                            },
                        }
                    }]
                },
                tooltips: {
                    enabled: true,
                    mode: 'label',
                    callbacks: {
                        title: function(tooltipItems, data) {
                            var idx = tooltipItems[0].index;
                            return data.labels[idx]; //do something with title
                        },
                    }
                },
                legend: {
                    display: true,
                    position: 'bottom'

                },
            }
        });

        //Footfall
        var ffBH = document.getElementById("homeRegion").getContext('2d');
        var ffByHr = new Chart(ffBH, {
            type: 'horizontalBar',
            data: {
                labels: [
                    'Virginia, US', 'Illinois, US', 'Washington, US', 'Massachusetts, US', 'Tennessee, US', 'Michigan, US', 'New York, US', 'Pennsylvania, US', 'Minnesota, US', 'Utah, US', 'Colorado, US', 'Florida, US', 'Texas, US', 'Ohio, US', 'California, US'
                ],
                datasets: [{
                    label: 'Peet\'s',
                    data: [1.157159425, 1.123964543, 1.112147701, 1.079088305, 1.071666307, 1.068897666, 1.063356444, 1.053247826, 1.030666912, 1.02734554, 1.025694389, 1.003181631, 1.002958137, 1.002199274, 1.000495434, 0.9960720459, 0.985471638, 0.9721707637, 0.9201556068, 0.8709896028, 0.8421482932, ],
                    backgroundColor: 'rgba(255, 170, 34, 0.6)',
                    borderColor: 'rgb(255, 170, 34)',
                    borderWidth: 1
                }, ]
            },
            options: {
                scales: {
                    xAxes: [{
                        ticks: {
                            beginAtZero: true
                        },
                        scaleLabel: {
                            display: true,
                            labelString: 'Over/under index',
                        }
                    }],
                    yAxes: [{
                        gridLines: {
                            offsetGridLines: false
                        },
                        ticks: {
                            maxRotation: 0,
                            autoSkip: false,
                            callback: function(value) {
                                return (value.substr(0, 20)); //truncate
                            },
                        }
                    }]
                },
                tooltips: {
                    enabled: true,
                    mode: 'label',
                    callbacks: {
                        title: function(tooltipItems, data) {
                            var idx = tooltipItems[0].index;
                            return data.labels[idx]; //do something with title
                        },
                    }
                },
                legend: {
                    display: false
                },
            }
        });

    </script>
</body>
